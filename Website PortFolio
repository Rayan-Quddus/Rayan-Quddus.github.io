import React, { useMemo, useState } from "react";
import { motion } from "framer-motion";
import {
  Mail,
  Github,
  Linkedin,
  ExternalLink,
  ArrowRight,
  MapPin,
  GraduationCap,
  Cpu,
  Flame,
  Wind,
  Printer,
  Wrench,
  FileText,
  Search,
} from "lucide-react";

// Optional shadcn/ui components (available in ChatGPT canvas preview environments)
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Input } from "@/components/ui/input";

/**
 * Portfolio Starter (single-file)
 * - Tailwind styling
 * - Framer Motion animations
 * - Clean, modern layout
 * - Easy to customize
 */

const fadeUp = {
  hidden: { opacity: 0, y: 12 },
  show: (i = 0) => ({
    opacity: 1,
    y: 0,
    transition: { delay: 0.06 * i, duration: 0.5, ease: "easeOut" },
  }),
};

const container = {
  hidden: { opacity: 0 },
  show: {
    opacity: 1,
    transition: { staggerChildren: 0.06, delayChildren: 0.05 },
  },
};

function cn(...classes) {
  return classes.filter(Boolean).join(" ");
}

function Section({ id, title, subtitle, children }) {
  return (
    <section id={id} className="scroll-mt-24">
      <div className="mb-6">
        <h2 className="text-2xl md:text-3xl font-semibold tracking-tight">{title}</h2>
        {subtitle ? (
          <p className="mt-2 text-sm md:text-base text-muted-foreground max-w-3xl">
            {subtitle}
          </p>
        ) : null}
      </div>
      {children}
    </section>
  );
}

function Pill({ icon: Icon, children }) {
  return (
    <span className="inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1 text-sm">
      {Icon ? <Icon className="h-4 w-4" /> : null}
      <span className="leading-none">{children}</span>
    </span>
  );
}

function NavLink({ href, children }) {
  return (
    <a
      href={href}
      className="text-sm text-muted-foreground hover:text-foreground transition-colors"
    >
      {children}
    </a>
  );
}

function ProjectCard({ project }) {
  return (
    <motion.div variants={fadeUp}>
      <Card className="h-full rounded-2xl shadow-sm hover:shadow-md transition-shadow">
        <CardHeader className="space-y-2">
          <div className="flex items-start justify-between gap-3">
            <CardTitle className="text-lg">{project.title}</CardTitle>
            <div className="flex items-center gap-2">
              {project.links?.map((l) => (
                <a
                  key={l.label}
                  href={l.href}
                  target="_blank"
                  rel="noreferrer"
                  className="inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground"
                  title={l.label}
                >
                  <ExternalLink className="h-4 w-4" />
                </a>
              ))}
            </div>
          </div>
          <p className="text-sm text-muted-foreground">{project.oneLiner}</p>
          <div className="flex flex-wrap gap-2">
            {project.tags.map((t) => (
              <Badge key={t} variant="secondary" className="rounded-full">
                {t}
              </Badge>
            ))}
          </div>
        </CardHeader>
        <CardContent className="space-y-3">
          <ul className="text-sm leading-relaxed text-muted-foreground list-disc pl-5">
            {project.highlights.map((h, idx) => (
              <li key={idx}>{h}</li>
            ))}
          </ul>
          {project.cta ? (
            <div className="pt-1">
              <a
                href={project.cta.href}
                target="_blank"
                rel="noreferrer"
                className="inline-flex items-center gap-2 text-sm font-medium hover:underline"
              >
                {project.cta.label} <ArrowRight className="h-4 w-4" />
              </a>
            </div>
          ) : null}
        </CardContent>
      </Card>
    </motion.div>
  );
}

export default function Portfolio() {
  // === Customize these ===
  const profile = useMemo(
    () => ({
      name: "Your Name",
      role: "Graduate Research Assistant • Thermal/Fluids • CFD",
      location: "Long Beach, CA",
      email: "you@email.com",
      links: {
        github: "https://github.com/your-handle",
        linkedin: "https://www.linkedin.com/in/your-handle",
      },
      highlights: [
        { icon: Flame, label: "Pool boiling & heat transfer" },
        { icon: Wind, label: "CFD & aerodynamics" },
        { icon: Cpu, label: "LabVIEW + NI DAQ" },
        { icon: Printer, label: "3D printing & prototyping" },
        { icon: Wrench, label: "CNC + experimental setups" },
      ],
      about:
        "I’m a graduate researcher working on enhancing pool boiling heat transfer for aerospace avionics cooling. My work combines experiments (HTC, bubble dynamics, IR thermography, high-speed imaging) with modeling and CFD. I also build test infrastructure with LabVIEW, DAQ systems, and custom hardware.",
      education: [
        {
          school: "California State University, Long Beach",
          degree: "M.S., Aerospace Engineering (CFD & Aerodynamics)",
          date: "Expected Dec 2026",
        },
      ],
      experience: [
        {
          title: "Graduate Research Assistant",
          org: "CSULB",
          date: "2025 – Present",
          bullets: [
            "Designed and executed pool boiling experiments using dielectric fluids and surfactants; quantified HTC and nucleation behavior.",
            "Built data acquisition & heater control workflows in LabVIEW using NI DAQ; implemented ramp/step control and logging.",
            "Performed image-based analysis (high-speed + shadowgraph) and IR thermography to map surface temperature fields.",
          ],
        },
        {
          title: "Engineering Intern (replace)",
          org: "Company / Lab",
          date: "Summer 2025",
          bullets: [
            "Delivered (project outcome) with (tools) and (measurable impact).",
            "Collaborated with (team) to (result).",
          ],
        },
      ],
      projects: [
        {
          title: "IR Thermography + Boiling Map Pipeline",
          oneLiner: "Process IR videos to extract transient surface temperature and correlate with bubble dynamics.",
          tags: ["Python", "Thermal", "Image processing"],
          highlights: [
            "Calibrated emissivity/optics workflow and produced time-resolved temperature maps.",
            "Aligned high-speed and IR timelines to connect nucleation events with local temperature drops.",
            "Generated automated reports and plots for repeated experimental runs.",
          ],
          links: [
            { label: "Repo", href: "https://github.com/your-handle/project" },
          ],
          cta: { label: "Read brief", href: "#" },
        },
        {
          title: "DAQ Heater Control VI (LabVIEW)",
          oneLiner: "A clean LabVIEW VI for thermocouple read + analog heater control, with SSR digital channels.",
          tags: ["LabVIEW", "NI DAQ", "Controls"],
          highlights: [
            "Implemented smooth ramp generation and safety limits.",
            "Logged synchronized temperature + command signals for repeatability.",
            "Modular channel configuration to support multiple SSR outputs.",
          ],
          links: [{ label: "Demo", href: "#" }],
        },
        {
          title: "CFD Validation: Flow Through Cone Valve",
          oneLiner: "Validation study comparing CFD predictions to reference data for internal flow through a cone valve.",
          tags: ["CFD", "Validation", "Star-CCM+"],
          highlights: [
            "Set up mesh/BC sensitivity and quantified uncertainty vs. benchmark cases.",
            "Compared pressure drop and velocity profiles across operating points.",
            "Documented a reproducible workflow for future validation tasks.",
          ],
          links: [{ label: "Report", href: "#" }],
        },
      ],
      skills: {
        "Thermal/Fluids": [
          "Pool/flow boiling",
          "Heat transfer coefficient extraction",
          "Multiphase visualization",
          "IR thermography",
        ],
        "CFD/Modeling": ["Star-CCM+", "ANSYS/other", "Meshing", "Validation"],
        "Data/Tools": ["Python", "MATLAB", "LabVIEW", "NI DAQ"],
        "Fabrication": ["3D printing", "CNC", "Laser etching", "Surface prep"],
      },
    }),
    []
  );

  const [query, setQuery] = useState("");
  const filteredProjects = useMemo(() => {
    const q = query.trim().toLowerCase();
    if (!q) return profile.projects;
    return profile.projects.filter((p) => {
      const hay = [p.title, p.oneLiner, ...(p.tags || []), ...(p.highlights || [])]
        .join(" ")
        .toLowerCase();
      return hay.includes(q);
    });
  }, [profile.projects, query]);

  return (
    <div className="min-h-screen bg-gradient-to-b from-background via-background to-muted/30 text-foreground">
      {/* Top Nav */}
      <header className="sticky top-0 z-50 border-b bg-background/70 backdrop-blur">
        <div className="mx-auto max-w-6xl px-4 py-3 flex items-center justify-between">
          <a href="#top" className="font-semibold tracking-tight">
            {profile.name}
          </a>
          <nav className="hidden md:flex items-center gap-6">
            <NavLink href="#about">About</NavLink>
            <NavLink href="#projects">Projects</NavLink>
            <NavLink href="#experience">Experience</NavLink>
            <NavLink href="#skills">Skills</NavLink>
            <NavLink href="#contact">Contact</NavLink>
          </nav>
          <div className="flex items-center gap-2">
            <a
              href={profile.links.github}
              target="_blank"
              rel="noreferrer"
              className="inline-flex"
              aria-label="GitHub"
            >
              <Button variant="ghost" size="icon" className="rounded-xl">
                <Github className="h-5 w-5" />
              </Button>
            </a>
            <a
              href={profile.links.linkedin}
              target="_blank"
              rel="noreferrer"
              className="inline-flex"
              aria-label="LinkedIn"
            >
              <Button variant="ghost" size="icon" className="rounded-xl">
                <Linkedin className="h-5 w-5" />
              </Button>
            </a>
          </div>
        </div>
      </header>

      {/* Hero */}
      <main id="top" className="mx-auto max-w-6xl px-4">
        <motion.section
          initial="hidden"
          animate="show"
          variants={container}
          className="py-12 md:py-16"
        >
          <motion.p
            variants={fadeUp}
            className="inline-flex items-center gap-2 text-sm text-muted-foreground"
          >
            <MapPin className="h-4 w-4" /> {profile.location}
          </motion.p>
          <motion.h1
            variants={fadeUp}
            className="mt-3 text-4xl md:text-6xl font-semibold tracking-tight"
          >
            {profile.role}
          </motion.h1>
          <motion.p
            variants={fadeUp}
            className="mt-4 max-w-3xl text-base md:text-lg text-muted-foreground"
          >
            {profile.about}
          </motion.p>

          <motion.div variants={fadeUp} className="mt-6 flex flex-wrap gap-3">
            {profile.highlights.map((h) => (
              <Pill key={h.label} icon={h.icon}>
                {h.label}
              </Pill>
            ))}
          </motion.div>

          <motion.div variants={fadeUp} className="mt-8 flex flex-wrap gap-3">
            <a href="#projects">
              <Button className="rounded-2xl">
                View projects <ArrowRight className="h-4 w-4 ml-2" />
              </Button>
            </a>
            <a href={`mailto:${profile.email}`}>
              <Button variant="secondary" className="rounded-2xl">
                <Mail className="h-4 w-4 mr-2" /> Email me
              </Button>
            </a>
            <a href="#contact">
              <Button variant="outline" className="rounded-2xl">
                <FileText className="h-4 w-4 mr-2" /> Resume / links
              </Button>
            </a>
          </motion.div>
        </motion.section>

        {/* Content */}
        <div className="pb-16 space-y-14">
          <Section
            id="about"
            title="About"
            subtitle="A quick snapshot of what I work on and how I like to build."
          >
            <div className="grid md:grid-cols-3 gap-6">
              <Card className="rounded-2xl shadow-sm md:col-span-2">
                <CardHeader>
                  <CardTitle className="text-lg">What I do</CardTitle>
                </CardHeader>
                <CardContent className="text-sm md:text-base text-muted-foreground leading-relaxed">
                  <p>
                    I combine experimental thermal-fluids research with practical instrumentation and
                    analysis. I enjoy building repeatable workflows—from DAQ/controls, to data
                    reduction, to clean documentation.
                  </p>
                  <div className="mt-4 grid sm:grid-cols-2 gap-3">
                    <Pill icon={Flame}>Boiling heat transfer experiments</Pill>
                    <Pill icon={Cpu}>LabVIEW + DAQ automation</Pill>
                    <Pill icon={Wind}>CFD for validation + insight</Pill>
                    <Pill icon={Printer}>Rapid prototyping & fixtures</Pill>
                  </div>
                </CardContent>
              </Card>

              <Card className="rounded-2xl shadow-sm">
                <CardHeader>
                  <CardTitle className="text-lg flex items-center gap-2">
                    <GraduationCap className="h-5 w-5" /> Education
                  </CardTitle>
                </CardHeader>
                <CardContent className="space-y-3">
                  {profile.education.map((e) => (
                    <div key={e.school} className="text-sm">
                      <div className="font-medium">{e.school}</div>
                      <div className="text-muted-foreground">{e.degree}</div>
                      <div className="text-muted-foreground">{e.date}</div>
                    </div>
                  ))}
                </CardContent>
              </Card>
            </div>
          </Section>

          <Section
            id="projects"
            title="Projects"
            subtitle="A few things I’ve built—research, tooling, and simulation workflows."
          >
            <div className="mb-5 flex flex-col sm:flex-row sm:items-center gap-3">
              <div className="relative w-full sm:max-w-md">
                <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
                <Input
                  value={query}
                  onChange={(e) => setQuery(e.target.value)}
                  placeholder="Search projects (e.g., IR, CFD, LabVIEW…)"
                  className="pl-9 rounded-2xl"
                />
              </div>
              <div className="text-sm text-muted-foreground">
                Showing <span className="font-medium text-foreground">{filteredProjects.length}</span> of{" "}
                <span className="font-medium text-foreground">{profile.projects.length}</span>
              </div>
            </div>

            <motion.div
              initial="hidden"
              whileInView="show"
              viewport={{ once: true, amount: 0.2 }}
              variants={container}
              className="grid md:grid-cols-2 lg:grid-cols-3 gap-6"
            >
              {filteredProjects.map((p) => (
                <ProjectCard key={p.title} project={p} />
              ))}
            </motion.div>
          </Section>

          <Section
            id="experience"
            title="Experience"
            subtitle="Roles, internships, and research work. Keep it impact-focused."
          >
            <div className="grid lg:grid-cols-2 gap-6">
              {profile.experience.map((x, idx) => (
                <motion.div
                  key={x.title}
                  initial="hidden"
                  whileInView="show"
                  viewport={{ once: true, amount: 0.2 }}
                  variants={fadeUp}
                  custom={idx}
                >
                  <Card className="rounded-2xl shadow-sm">
                    <CardHeader className="space-y-1">
                      <div className="flex items-start justify-between gap-3">
                        <CardTitle className="text-lg">{x.title}</CardTitle>
                        <Badge variant="secondary" className="rounded-full">
                          {x.date}
                        </Badge>
                      </div>
                      <div className="text-sm text-muted-foreground">{x.org}</div>
                    </CardHeader>
                    <CardContent>
                      <ul className="text-sm text-muted-foreground leading-relaxed list-disc pl-5 space-y-1">
                        {x.bullets.map((b, i) => (
                          <li key={i}>{b}</li>
                        ))}
                      </ul>
                    </CardContent>
                  </Card>
                </motion.div>
              ))}
            </div>
          </Section>

          <Section
            id="skills"
            title="Skills"
            subtitle="Group your skills so it’s easy to scan. Tailor this to the roles you want."
          >
            <div className="grid md:grid-cols-2 gap-6">
              {Object.entries(profile.skills).map(([group, items]) => (
                <Card key={group} className="rounded-2xl shadow-sm">
                  <CardHeader>
                    <CardTitle className="text-lg">{group}</CardTitle>
                  </CardHeader>
                  <CardContent className="flex flex-wrap gap-2">
                    {items.map((s) => (
                      <Badge key={s} variant="outline" className="rounded-full">
                        {s}
                      </Badge>
                    ))}
                  </CardContent>
                </Card>
              ))}
            </div>
          </Section>

          <Section
            id="contact"
            title="Contact"
            subtitle="Make it effortless for someone to reach you."
          >
            <Card className="rounded-2xl shadow-sm">
              <CardContent className="p-6 md:p-8">
                <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                  <div>
                    <div className="text-lg font-semibold">Let’s connect</div>
                    <div className="text-sm text-muted-foreground mt-1">
                      Email is best. I’m happy to share a resume or discuss collaboration.
                    </div>
                  </div>
                  <div className="flex flex-wrap gap-3">
                    <a href={`mailto:${profile.email}`}>
                      <Button className="rounded-2xl">
                        <Mail className="h-4 w-4 mr-2" /> {profile.email}
                      </Button>
                    </a>
                    <a href={profile.links.linkedin} target="_blank" rel="noreferrer">
                      <Button variant="secondary" className="rounded-2xl">
                        <Linkedin className="h-4 w-4 mr-2" /> LinkedIn
                      </Button>
                    </a>
                    <a href={profile.links.github} target="_blank" rel="noreferrer">
                      <Button variant="outline" className="rounded-2xl">
                        <Github className="h-4 w-4 mr-2" /> GitHub
                      </Button>
                    </a>
                  </div>
                </div>
              </CardContent>
            </Card>

            <footer className="mt-8 pb-10 text-center text-xs text-muted-foreground">
              <div>
                Built with React + Tailwind. Customize the <span className="font-medium text-foreground">profile</span>
                {" "}
                object at the top.
              </div>
            </footer>
          </Section>
        </div>
      </main>
    </div>
  );
}
